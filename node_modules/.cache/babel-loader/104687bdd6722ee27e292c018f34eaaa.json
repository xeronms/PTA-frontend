{"ast":null,"code":"import _classCallCheck from \"C:/Users/ESG-dell/Documents/Dev/Hachathon-miasta/PTA-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/ESG-dell/Documents/Dev/Hachathon-miasta/PTA-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\n\nvar VectorTileFeature = /*#__PURE__*/function () {\n  function VectorTileFeature(pbf, end, extent, keys, values) {\n    _classCallCheck(this, VectorTileFeature);\n\n    this.properties = {};\n    this.extent = extent;\n    this.type = 0;\n    this.id = null;\n    this._pbf = pbf;\n    this._geometry = -1;\n    this._keys = keys;\n    this._values = values;\n    pbf.readFields(readFeature, this, end);\n  }\n\n  _createClass(VectorTileFeature, [{\n    key: \"loadGeometry\",\n    value: function loadGeometry() {\n      var pbf = this._pbf;\n      pbf.pos = this._geometry;\n      var end = pbf.readVarint() + pbf.pos;\n      var cmd = 1;\n      var length = 0;\n      var x = 0;\n      var y = 0;\n      var lines = [];\n      var line;\n\n      while (pbf.pos < end) {\n        if (length <= 0) {\n          var cmdLen = pbf.readVarint();\n          cmd = cmdLen & 0x7;\n          length = cmdLen >> 3;\n        }\n\n        length--;\n\n        if (cmd === 1 || cmd === 2) {\n          x += pbf.readSVarint();\n          y += pbf.readSVarint();\n\n          if (cmd === 1) {\n            if (line) lines.push(line);\n            line = [];\n          }\n\n          line.push([x, y]);\n        } else if (cmd === 7) {\n          if (line) {\n            line.push(line[0].slice());\n          }\n        } else {\n          throw new Error(\"unknown command \".concat(cmd));\n        }\n      }\n\n      if (line) lines.push(line);\n      return lines;\n    }\n  }, {\n    key: \"bbox\",\n    value: function bbox() {\n      var pbf = this._pbf;\n      pbf.pos = this._geometry;\n      var end = pbf.readVarint() + pbf.pos;\n      var cmd = 1;\n      var length = 0;\n      var x = 0;\n      var y = 0;\n      var x1 = Infinity;\n      var x2 = -Infinity;\n      var y1 = Infinity;\n      var y2 = -Infinity;\n\n      while (pbf.pos < end) {\n        if (length <= 0) {\n          var cmdLen = pbf.readVarint();\n          cmd = cmdLen & 0x7;\n          length = cmdLen >> 3;\n        }\n\n        length--;\n\n        if (cmd === 1 || cmd === 2) {\n          x += pbf.readSVarint();\n          y += pbf.readSVarint();\n          if (x < x1) x1 = x;\n          if (x > x2) x2 = x;\n          if (y < y1) y1 = y;\n          if (y > y2) y2 = y;\n        } else if (cmd !== 7) {\n          throw new Error(\"unknown command \".concat(cmd));\n        }\n      }\n\n      return [x1, y1, x2, y2];\n    }\n  }, {\n    key: \"_toGeoJSON\",\n    value: function _toGeoJSON(transform) {\n      var coords = this.loadGeometry();\n      var type = VectorTileFeature.types[this.type];\n      var i;\n      var j;\n\n      switch (this.type) {\n        case 1:\n          var points = [];\n\n          for (i = 0; i < coords.length; i++) {\n            points[i] = coords[i][0];\n          }\n\n          coords = points;\n          transform(coords, this);\n          break;\n\n        case 2:\n          for (i = 0; i < coords.length; i++) {\n            transform(coords[i], this);\n          }\n\n          break;\n\n        case 3:\n          coords = classifyRings(coords);\n\n          for (i = 0; i < coords.length; i++) {\n            for (j = 0; j < coords[i].length; j++) {\n              transform(coords[i][j], this);\n            }\n          }\n\n          break;\n      }\n\n      if (coords.length === 1) {\n        coords = coords[0];\n      } else {\n        type = \"Multi\".concat(type);\n      }\n\n      var result = {\n        type: 'Feature',\n        geometry: {\n          type: type,\n          coordinates: coords\n        },\n        properties: this.properties\n      };\n\n      if (this.id !== null) {\n        result.id = this.id;\n      }\n\n      return result;\n    }\n  }, {\n    key: \"toGeoJSON\",\n    value: function toGeoJSON(options) {\n      if (typeof options === 'function') {\n        return this._toGeoJSON(options);\n      }\n\n      var x = options.x,\n          y = options.y,\n          z = options.z;\n      var size = this.extent * Math.pow(2, z);\n      var x0 = this.extent * x;\n      var y0 = this.extent * y;\n\n      function project(line) {\n        for (var j = 0; j < line.length; j++) {\n          var p = line[j];\n          p[0] = (p[0] + x0) * 360 / size - 180;\n          var y2 = 180 - (p[1] + y0) * 360 / size;\n          p[1] = 360 / Math.PI * Math.atan(Math.exp(y2 * Math.PI / 180)) - 90;\n        }\n      }\n\n      return this._toGeoJSON(project);\n    }\n  }], [{\n    key: \"types\",\n    get: function get() {\n      return ['Unknown', 'Point', 'LineString', 'Polygon'];\n    }\n  }]);\n\n  return VectorTileFeature;\n}();\n\nexport { VectorTileFeature as default };\n\nfunction classifyRings(rings) {\n  var len = rings.length;\n  if (len <= 1) return [rings];\n  var polygons = [];\n  var polygon;\n  var ccw;\n\n  for (var i = 0; i < len; i++) {\n    var area = signedArea(rings[i]);\n    if (area === 0) continue;\n    if (ccw === undefined) ccw = area < 0;\n\n    if (ccw === area < 0) {\n      if (polygon) polygons.push(polygon);\n      polygon = [rings[i]];\n    } else {\n      polygon.push(rings[i]);\n    }\n  }\n\n  if (polygon) polygons.push(polygon);\n  return polygons;\n}\n\nfunction signedArea(ring) {\n  var sum = 0;\n\n  for (var i = 0, j = ring.length - 1, p1, p2; i < ring.length; j = i++) {\n    p1 = ring[i];\n    p2 = ring[j];\n    sum += (p2[0] - p1[0]) * (p1[1] + p2[1]);\n  }\n\n  return sum;\n}\n\nfunction readFeature(tag, feature, pbf) {\n  if (tag === 1) feature.id = pbf.readVarint();else if (tag === 2) readTag(pbf, feature);else if (tag === 3) feature.type = pbf.readVarint();else if (tag === 4) feature._geometry = pbf.pos;\n}\n\nfunction readTag(pbf, feature) {\n  var end = pbf.readVarint() + pbf.pos;\n\n  while (pbf.pos < end) {\n    var key = feature._keys[pbf.readVarint()];\n\n    var value = feature._values[pbf.readVarint()];\n\n    feature.properties[key] = value;\n  }\n}","map":{"version":3,"sources":["../../../../src/lib/mapbox-vector-tile/vector-tile-feature.js"],"names":["types","constructor","pbf","loadGeometry","end","cmd","length","x","y","lines","cmdLen","line","bbox","x1","x2","y1","y2","_toGeoJSON","coords","type","VectorTileFeature","points","i","transform","classifyRings","j","result","geometry","coordinates","properties","toGeoJSON","z","size","Math","x0","y0","p","len","rings","polygons","area","signedArea","ccw","polygon","sum","ring","p1","p2","tag","feature","readTag","key","value"],"mappings":"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","sourcesContent":["// This code is forked from https://github.com/mapbox/vector-tile-js under BSD 3-clause license.\n/* eslint-disable */\n\nexport default class VectorTileFeature {\n  static get types() {\n    return ['Unknown', 'Point', 'LineString', 'Polygon'];\n  }\n\n  constructor(pbf, end, extent, keys, values) {\n    // Public\n    this.properties = {};\n    this.extent = extent;\n    this.type = 0;\n    this.id = null;\n\n    // Private\n    this._pbf = pbf;\n    this._geometry = -1;\n    this._keys = keys;\n    this._values = values;\n\n    pbf.readFields(readFeature, this, end);\n  }\n\n  // eslint-disable-next-line complexity, max-statements\n  loadGeometry() {\n    const pbf = this._pbf;\n    pbf.pos = this._geometry;\n\n    const end = pbf.readVarint() + pbf.pos;\n    let cmd = 1;\n    let length = 0;\n    let x = 0;\n    let y = 0;\n    const lines = [];\n    let line;\n\n    while (pbf.pos < end) {\n      if (length <= 0) {\n        const cmdLen = pbf.readVarint();\n        cmd = cmdLen & 0x7;\n        length = cmdLen >> 3;\n      }\n\n      length--;\n\n      if (cmd === 1 || cmd === 2) {\n        x += pbf.readSVarint();\n        y += pbf.readSVarint();\n\n        if (cmd === 1) {\n          // moveTo\n          if (line) lines.push(line);\n          line = [];\n        }\n        // @ts-ignore\n        line.push([x, y]);\n      } else if (cmd === 7) {\n        // Workaround for https://github.com/mapbox/mapnik-vector-tile/issues/90\n        if (line) {\n          line.push(line[0].slice()); // closePolygon\n        }\n      } else {\n        throw new Error(`unknown command ${cmd}`);\n      }\n    }\n\n    if (line) lines.push(line);\n\n    return lines;\n  }\n\n  // eslint-disable-next-line max-statements\n  bbox() {\n    const pbf = this._pbf;\n    pbf.pos = this._geometry;\n\n    const end = pbf.readVarint() + pbf.pos;\n    let cmd = 1;\n    let length = 0;\n    let x = 0;\n    let y = 0;\n    let x1 = Infinity;\n    let x2 = -Infinity;\n    let y1 = Infinity;\n    let y2 = -Infinity;\n\n    while (pbf.pos < end) {\n      if (length <= 0) {\n        const cmdLen = pbf.readVarint();\n        cmd = cmdLen & 0x7;\n        length = cmdLen >> 3;\n      }\n\n      length--;\n\n      if (cmd === 1 || cmd === 2) {\n        x += pbf.readSVarint();\n        y += pbf.readSVarint();\n        if (x < x1) x1 = x;\n        if (x > x2) x2 = x;\n        if (y < y1) y1 = y;\n        if (y > y2) y2 = y;\n      } else if (cmd !== 7) {\n        throw new Error(`unknown command ${cmd}`);\n      }\n    }\n\n    return [x1, y1, x2, y2];\n  }\n\n  _toGeoJSON(transform) {\n    let coords = this.loadGeometry();\n    let type = VectorTileFeature.types[this.type];\n    let i;\n    let j;\n\n    switch (this.type) {\n      case 1:\n        var points = [];\n        for (i = 0; i < coords.length; i++) {\n          points[i] = coords[i][0];\n        }\n        coords = points;\n        transform(coords, this);\n        break;\n\n      case 2:\n        for (i = 0; i < coords.length; i++) {\n          transform(coords[i], this);\n        }\n        break;\n\n      case 3:\n        coords = classifyRings(coords);\n        for (i = 0; i < coords.length; i++) {\n          for (j = 0; j < coords[i].length; j++) {\n            transform(coords[i][j], this);\n          }\n        }\n        break;\n    }\n\n    if (coords.length === 1) {\n      coords = coords[0];\n    } else {\n      type = `Multi${type}`;\n    }\n\n    const result = {\n      type: 'Feature',\n      geometry: {\n        type,\n        coordinates: coords\n      },\n      properties: this.properties\n    };\n\n    if (this.id !== null) {\n      result.id = this.id;\n    }\n\n    return result;\n  }\n\n  toGeoJSON(options) {\n    if (typeof options === 'function') {\n      return this._toGeoJSON(options);\n    }\n    const {x, y, z} = options;\n    const size = this.extent * Math.pow(2, z);\n    const x0 = this.extent * x;\n    const y0 = this.extent * y;\n\n    function project(line) {\n      for (let j = 0; j < line.length; j++) {\n        const p = line[j];\n        p[0] = ((p[0] + x0) * 360) / size - 180;\n        const y2 = 180 - ((p[1] + y0) * 360) / size;\n        p[1] = (360 / Math.PI) * Math.atan(Math.exp((y2 * Math.PI) / 180)) - 90;\n      }\n    }\n    return this._toGeoJSON(project);\n  }\n}\n\n/**\n * Classifies an array of rings into polygons with outer rings and holes\n */\n\nfunction classifyRings(rings) {\n  const len = rings.length;\n\n  if (len <= 1) return [rings];\n\n  const polygons = [];\n  let polygon;\n  let ccw;\n\n  for (let i = 0; i < len; i++) {\n    const area = signedArea(rings[i]);\n    if (area === 0) continue;\n\n    if (ccw === undefined) ccw = area < 0;\n\n    if (ccw === area < 0) {\n      if (polygon) polygons.push(polygon);\n      polygon = [rings[i]];\n    } else {\n      // @ts-ignore\n      polygon.push(rings[i]);\n    }\n  }\n  if (polygon) polygons.push(polygon);\n\n  return polygons;\n}\n\nfunction signedArea(ring) {\n  let sum = 0;\n  for (let i = 0, j = ring.length - 1, p1, p2; i < ring.length; j = i++) {\n    p1 = ring[i];\n    p2 = ring[j];\n    sum += (p2[0] - p1[0]) * (p1[1] + p2[1]);\n  }\n  return sum;\n}\n\nfunction readFeature(tag, feature, pbf) {\n  if (tag === 1) feature.id = pbf.readVarint();\n  else if (tag === 2) readTag(pbf, feature);\n  else if (tag === 3) feature.type = pbf.readVarint();\n  else if (tag === 4) feature._geometry = pbf.pos;\n}\n\nfunction readTag(pbf, feature) {\n  const end = pbf.readVarint() + pbf.pos;\n\n  while (pbf.pos < end) {\n    const key = feature._keys[pbf.readVarint()];\n    const value = feature._values[pbf.readVarint()];\n    feature.properties[key] = value;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}